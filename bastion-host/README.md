# Bastion Host

Point of this project was to increase security by reducing attack surfaces using a hardened unix like (Here debian) os on a server which provides only one way to access to my VPC from outside (Internet).
project <a href="https://roadmap.sh/projects/bastion-host">link</a>.

This is the idea:

<div
style="background-color: white; width: max-content; height: max-content"
><svg xmlns="http://www.w3.org/2000/svg" width="730" height="400" fill="none" viewBox="0 0 730 400"><g clip-path="url(#1e00818f__clip0_5_476)"><g filter="url(#1e00818f__filter0_d_5_476)"><rect width="654" height="371" x="3" y="19" fill="#fff" rx="10"></rect></g><g filter="url(#1e00818f__filter1_d_5_476)"><rect width="634" height="301" x="13" y="79" fill="#fff" rx="10"></rect></g><path fill="#4E496B" d="m170 285-5.774 10h11.548L170 285Zm-1 9v22h2v-22h-2Zm-7 29H73v2h89v-2Zm7-7a7 7 0 0 1-7 7v2a9 9 0 0 0 9-9h-2Zm122 8-10 5.774v-11.548L291 324Zm-109-39v31h-2v-31h2Zm7 38h93v2h-93v-2Zm-7-7a7 7 0 0 0 7 7v2a9 9 0 0 1-9-9h2Zm298-31-5.774 10h11.548L480 285Zm-1 9v22h2v-22h-2Zm-7 29H370v2h102v-2Zm7-7a7 7 0 0 1-7 7v2a9 9 0 0 0 9-9h-2Zm197 8-10 5.774v-11.548L676 324Zm-184-39v31h-2v-31h2Zm7 38h168v2H499v-2Zm-7-7a7 7 0 0 0 7 7v2a9 9 0 0 1-9-9h2Z"></path><g fill-rule="evenodd" clip-path="url(#1e00818f__clip1_5_476)" clip-rule="evenodd"><path fill="#5282FF" d="M706 302c12.143 0 22 9.856 22 22s-9.857 22-22 22-22-9.856-22-22 9.857-22 22-22Z"></path><path fill="#fff" d="M697.145 333.529c-.4-.173-.645-.332-.74-.735-.123-.966.117-1.691.74-2.198 1.999-1.312 4.675-1.883 6.04-2.779.462-.377.44-.882.399-1.238-.041-.347-.228-.701-.536-1.119-1.156-1.338-2.214-3.31-2.214-7.333 0-1.869.833-3.475 2.118-4.348.907-.618 2.131-.783 3.048-.783.917 0 2.14.165 3.048.783 1.285.873 2.118 2.479 2.118 4.348 0 4.023-1.057 5.995-2.214 7.333-.308.416-.495.772-.536 1.119-.041.356-.063.861.399 1.238 1.365.898 4.041 1.467 6.04 2.779.623.509.862 1.232.74 2.198-.096.403-.34.564-.74.735-2.203.876-5.566 1.467-8.855 1.467-3.289 0-6.652-.591-8.855-1.467Z"></path></g><rect width="300" height="144" x="25" y="141" fill="#DDF2E1" rx="5"></rect><rect width="300" height="144" x="335" y="141" fill="#DAEEF9" rx="10"></rect><g fill-rule="evenodd" clip-path="url(#1e00818f__clip2_5_476)" clip-rule="evenodd"><path fill="#5282FF" d="M46 302c12.143 0 22 9.856 22 22s-9.857 22-22 22-22-9.856-22-22 9.857-22 22-22Z"></path><path fill="#fff" d="m37.75 331.111-.003-3.155c.696.549 1.56.945 2.395 1.226 1.615.551 3.665.861 5.858.861 2.193 0 4.243-.31 5.856-.861.835-.281 1.701-.677 2.394-1.226v3.155c0 1.766-3.696 3.2-8.25 3.2s-8.25-1.434-8.25-3.2Zm0-5.689-.003-3.155c.696.548 1.56.944 2.395 1.225 1.615.55 3.665.862 5.858.862 2.193 0 4.243-.312 5.856-.862.835-.281 1.701-.677 2.394-1.225v3.153c0 1.767-3.696 3.2-8.25 3.2s-8.25-1.433-8.25-3.2v.002Zm0-5.691-.003-3.155c.01.01.022.019.033.027.369-1.632 3.91-2.917 8.22-2.917 4.306 0 7.847 1.285 8.217 2.916l.033-.026v3.155c0 1.765-3.696 3.2-8.25 3.2s-8.25-1.435-8.25-3.2Z"></path></g><text xml:space="preserve" fill="#000" fill-opacity=".85" font-size="10" letter-spacing="0em" style="white-space:pre"><tspan x="28.49" y="364.42">test-vm</tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".85" font-size="10" letter-spacing="0em" style="white-space:pre"><tspan x="91.762" y="338.42">172.16.16.12</tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".85" font-size="10" letter-spacing="0em" style="white-space:pre"><tspan x="204.013" y="338.42">172.16.16.254</tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".85" font-size="10" letter-spacing="0em" style="white-space:pre"><tspan x="395.42" y="338.42">172.16.17.12</tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".85" font-size="10" letter-spacing="0em" style="white-space:pre"><tspan x="517.013" y="322.92">
</tspan><tspan x="517.013" y="337.92">51.250.110.18</tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".85" font-size="10" letter-spacing="0em" style="white-space:pre"><tspan x="529.908" y="318.42">Public IP</tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".85" font-size="12" letter-spacing="0em" style="white-space:pre"><tspan x="104.328" y="175.604">bastion-internal-segment</tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".85" font-size="12" letter-spacing="0em" style="white-space:pre"><tspan x="313.705" y="113.104">VPC</tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".85" font-size="12" letter-spacing="0em" style="white-space:pre"><tspan x="305.256" y="53.104">CLOUD</tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".85" font-size="12" letter-spacing="0em" style="white-space:pre"><tspan x="412.898" y="175.604">bastion-external-segment</tspan></text><g fill-rule="evenodd" clip-path="url(#1e00818f__clip3_5_476)" clip-rule="evenodd"><path fill="#5282FF" d="M330 302c12.143 0 22 9.856 22 22s-9.857 22-22 22-22-9.856-22-22 9.857-22 22-22Z"></path><path fill="#fff" d="m321.75 331.111-.003-3.155c.696.549 1.561.945 2.396 1.226 1.614.551 3.664.861 5.857.861s4.243-.31 5.856-.861c.835-.281 1.701-.677 2.394-1.226v3.155c0 1.766-3.696 3.2-8.25 3.2s-8.25-1.434-8.25-3.2Zm0-5.689-.003-3.155c.696.548 1.561.944 2.396 1.225 1.614.55 3.664.862 5.857.862s4.243-.312 5.856-.862c.835-.281 1.701-.677 2.394-1.225v3.153c0 1.767-3.696 3.2-8.25 3.2s-8.25-1.433-8.25-3.2v.002Zm0-5.691-.003-3.155.033.027c.369-1.632 3.911-2.917 8.22-2.917 4.307 0 7.847 1.285 8.217 2.916l.033-.026v3.155c0 1.765-3.696 3.2-8.25 3.2s-8.25-1.435-8.25-3.2Z"></path></g><text xml:space="preserve" fill="#000" fill-opacity=".85" font-size="10" letter-spacing="0em" style="white-space:pre"><tspan x="301.416" y="364.42">bastion-host</tspan></text><rect width="44" height="44" x="41" y="210" fill="#5282FF" rx="22"></rect><path fill="#fff" d="M72.565 221.478v13.546c0 2.212-1.347 4.116-3.31 5.115L63 243.478l-6.254-3.338c-1.964-1-3.311-2.904-3.311-5.116v-13.546h19.13Z"></path><text xml:space="preserve" fill="#000" fill-opacity=".85" font-size="10" letter-spacing="0em" style="white-space:pre"><tspan x="100" y="227.92">internal-bastion-sg
</tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".85" font-size="10" letter-spacing="0em" style="white-space:pre"><tspan x="100" y="212.92">Security group
</tspan><tspan x="100" y="242.92">egress: TCP port 22 Destination Self
</tspan><tspan x="100" y="257.92">ingress: TCP port 22 Source 172.16.16.254/32</tspan></text><rect width="44" height="44" x="351" y="210" fill="#5282FF" rx="22"></rect><path fill="#fff" d="M382.565 221.478v13.546c0 2.212-1.347 4.116-3.311 5.115L373 243.478l-6.254-3.338c-1.964-1-3.311-2.904-3.311-5.116v-13.546h19.13Z"></path><text xml:space="preserve" fill="#000" fill-opacity=".85" font-size="10" letter-spacing="0em" style="white-space:pre"><tspan x="410" y="227.92">sequre-bastion-sg
</tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".85" font-size="10" letter-spacing="0em" style="white-space:pre"><tspan x="410" y="212.92">Security group
</tspan><tspan x="410" y="242.92">ingress: TCP port 22 Source 0.0.0.0/0
</tspan></text><path fill="#18123D" d="m459 334.5 10 5.774v-11.548l-10 5.774Zm53 0-10-5.774v11.548l10-5.774Zm-47.321 1h3.785v-2h-3.785v2Zm7.571 0h3.786v-2h-3.786v2Zm7.571 0h3.786v-2h-3.786v2Zm7.572 0h3.786v-2h-3.786v2Zm7.571 0h3.786v-2h-3.786v2Zm7.572 0h3.785v-2h-3.785v2Z" opacity=".5"></path></g><defs><clipPath id="1e00818f__clip0_5_476"><path fill="#fff" d="M0 0h730v400H0z"></path></clipPath><clipPath id="1e00818f__clip1_5_476"><path fill="#fff" d="M684 302h44v44h-44z"></path></clipPath><clipPath id="1e00818f__clip2_5_476"><path fill="#fff" d="M24 302h44v44H24z"></path></clipPath><clipPath id="1e00818f__clip3_5_476"><path fill="#fff" d="M308 302h44v44h-44z"></path></clipPath><filter id="1e00818f__filter0_d_5_476" width="670" height="387" x="-5" y="11" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"></feColorMatrix><feOffset></feOffset><feGaussianBlur stdDeviation="4"></feGaussianBlur><feColorMatrix values="0 0 0 0 0.321569 0 0 0 0 0.509804 0 0 0 0 1 0 0 0 0.2 0"></feColorMatrix><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_5_476"></feBlend><feBlend in="SourceGraphic" in2="effect1_dropShadow_5_476" result="shape"></feBlend></filter><filter id="1e00818f__filter1_d_5_476" width="650" height="317" x="5" y="71" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"></feColorMatrix><feOffset></feOffset><feGaussianBlur stdDeviation="4"></feGaussianBlur><feColorMatrix values="0 0 0 0 0.321569 0 0 0 0 0.509804 0 0 0 0 1 0 0 0 0.2 0"></feColorMatrix><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_5_476"></feBlend><feBlend in="SourceGraphic" in2="effect1_dropShadow_5_476" result="shape"></feBlend></filter></defs></svg></div>

**Tutorial** <a href="https://yandex.cloud/en/docs/tutorials/routing/bastion#linux-macos_1">link</a>.

### How to do this?

- create your internal and external networks
- create security groups
- config your bastion host
- test connection to VMs in VPC
